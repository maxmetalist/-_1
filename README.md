# Репозиторий для первого курсача
## !!!ВНИМАНИЕ!!!
   Так как скачанный список транзакций ограничен декабрём 2021 года, то в функциях,
   принимающих не обязательный параметр "дата" нужно эту дату вводить.
   Иначе будет приниматься текущая дата по datetime и возвращаться пустой список.
## В модуле views реализованы следующие функции:
### total_consume_card_number
    Функция подсчёта общего количества расходов по номерам карт
    (учитываются только платежи со статусом OK)
### get_top5_transactions
    Возвращает 5 самых больших по модулю отрицательных транзакций со статусом OK
### На эти функции настроено логирование с записью в соответствующие файлы
    [views_card.log](logs/views_card.log) и [views_top5.log](logs/views_top5.log)
## Вспомогательные функции реализованы в модуле utils:
### get_current_time_string
    Функция получения текущего времени суток
### filter_transactions_by_current_month
    Фильтрует транзакции с начала месяца по указанную дату
    (если дата не указана, берётся текущая дата)
### На эти функции настроено логирование с записью в соответствующий файл
    [utils.log](logs/utils.log)
#### Список словарей с транзакциями берётся из функции чтения в модуле
     [xlsx_reader.py](src/xlsx_reader.py).
     Имя функции read_xlsx_transactions(transactions_xlsx_path):
     Функция, считывающая файл excel по указанному пути в директории data
## В модуле api_external реализованы следующие функции:
###  get_rate
     Функция получения курса валюты. Используется API https://apilayer.com
     Принимает параметр валют для конвертации
     Возвращает словарь с кодом валюты {'RUB': 94.437097}(здесь конвертация EUR по отношению к RUB)
### get_stocks_price
    Функция получения котировок акций во временном интервале 60мин
    Исполбзуется API https://www.alphavantage.co/documentation/
    Возвращает словарь вида {'symbol': 'IBM', 'price':
                            {'2025-04-22 19:00:00': '243.7400', '2025-04-22 18:00:00': '243.8100'}}
    Котировки берутся на текущую дату с временным интервалом в 60 минут
#### Для функций берутся соответствующие ключи apikey.
     Вместо API_KET_RATES поставьте свой ключ для APILayer,
     Вместо API_KEY_STOCK поставьте свой ключ для alfavantage
## В модуле servises реализованы следующие функции:
### filter_person_transfer
    Для поиска транзакций физ лицам в категории "Переводы"
    Поиск ведётся по всем транзакциям
### find_transactions_by_name
    Для поиска транзакций по имени получателя, запрашиваемого у пользователя
    Поиск так же ведётся по всем транзакциям
#### Если нужно вести поиск по конкретному периоду, можно подключить для поиска результат списка от функции
#### filter_transactions_by_current_month  из модуля utils через главную функцию в модуле main
## В модуле report_func реализована функция filter_transactions_by_category
### Функция фильтрует транзакции по заданным пользователем параметрам категория и дата
    Если дата не указана, берётся текущая дата по datetime
    Поиск ведётся за последние три месяца до указанной даты
## В модуле reports_decor реализован декоратор
### Декоратор сохраняет результат работы необходимой функции в файл
    Путь к файлу: [reports](data/reports) указывайте в декорируемой функции
    Если путь не указан, файл reports будет создан и записан в директории src
## В модуле main реализована функция, приветствующая пользователя в зависимости от текущего времени по datetime
### Функция выводит основные запросы от пользователя на основе имеющегося списка транзакций и функций в остальных модулях
    Реализованы циклические запросы на ввод необходимых параметров поиска
    и выводит результаты в формате json